<!DOCTYPE html>

{% load staticfiles %}
{% load crispy_forms_tags %}

<html>
<head>
	<meta charset="utf-8">
	<title>
		{% block title %}{% endblock %}
	</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

	<!-- Bootstrap core CSS -->
    <link href="{% static 'css/bootstrap.css' %}" rel="stylesheet">

    <!-- Custom Google Web Font -->
    <link href="{% static 'font-awesome/css/font-awesome.min.css' %}" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>

    <!-- Add custom CSS here -->
    <link href="{% static 'css/landing-page.css' %}" rel="stylesheet">
    <link href="{% static 'css/custom.css' %}" rel="stylesheet">

    <!-- Add JavaScript Files here -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script type="text/javascript" src="{% static 'js/jquery-validation-1.11.1/jquery.validate.js' %}"></script>
</head>
<body>
	<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Textile Fabric Consultants</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
           <div class="collapse navbar-collapse navbar-right navbar-ex1-collapse">
                <ul class="nav navbar-nav" name= "myNavBar" id="myNavbar">
                    <li><a href="/about/">About</a></li>
                    <li><a href="/contact/">Contact Us</a></li>
                    <li><a href="/blog/">Blog</a></li>
                    <li><a href="/webstore/category/Fiber%20Arts/">Store</a></li>
		    <li class="dropdown">
                    <a id="dropDownDefault" class="dropdown-toggle" data-toggle="dropdown" href="#">Login | Register<b class="caret"></b></a>
                    <ul id="menu1" class="dropdown-menu" aria-labelledby="dropDownDefault">
                    <li><a data-toggle="modal" data-target="#myOtherModal" href="#log-in">Login</a></li>
                    <li class="divider"></li>
                    <li><a data-toggle="modal" data-target="#myModal" href="#log-in">Register</a></li>
		    </ul>
                    </li>
		    
		    <li class="dropdown">
                    <a id="dropDownLoggedIn" class="dropdown-toggle" data-toggle="dropdown" href="#" >Account<b id="caret2" class="caret"></b></a>
                    <ul id="menu2" class="dropdown-menu" aria-labelledby="dropDownLoggedIn">
                    <li id="logOut"><a>Logout</a></li>
		    <script>$( "#logOut" ).click(function(){
				$.ajax({//begin
            
	    			
	    				type: 'POST', 
            				url:  '/login/logoutUser/', 
            				success: function(result){
		    				console.log('test')
						
						$('#logoutModal').modal('show');
             		  			changeNAV();
						$("#loggedInMessage").hide()
		  				$('#id-loginform').show()
		   			
             	  			 }//end success
            
                
           
	   
        	 			});//end ajax 
					
					});
			   
		    			</script>
			
                    <li class="divider"></li>
                    <li><a data-toggle="modal" data-target="#accountModal" href="#">Account</a></li>
		    </ul>
                    </li>
                    </ul>
		    
		    <script> 
	  changeNAV()<!--Important Need this call -->
	  function changeNAV() { 	
	
		$.ajax({//begin
            
	    			
	    		type: 'POST', 
            		url:  '/login/authenticateUser/', 
            		success: function(result){
		    
                       
             	   if(!result['success']){
			console.log('called1')			
			$('#dropDownDefault').show();
			$('#caret2').hide()
			$('#dropDownLoggedIn').hide();
			$('#loggedInMessage').hide();
             		  
		   }
		   else{
		   	console.log('called2')
			
			$('#dropDownDefault').hide();
			$('#caret2').show();
			$('#dropDownLoggedIn').show();
			
		   }
             	   }//end success
            
                
           
	   
        	 });//end ajax 
		 }</script>

			
		     
		    


                
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

	<div class="content push-down">
		{% block content %}
		{% endblock %}
	</div>

	<footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <p class="copyright text-muted small">Copyright &copy; Textile Fabric Consultants Inc {% now "Y" %}. All Rights Reserved. Use of this site constitutes your acceptance of our Terms of Use. Please see our Privacy and Security Statement.</p>
		    <div class="terms">
		    <button type="button" id="terms" class="btn btn-default" data-container="body" data-toggle="popover" data-placement="top" data-content="Terms of Use">Terms of Use </button>
		    <button type="button" id="privacy" class="btn btn-default" data-container="body" data-toggle="popover" data-placement="top" data-content="Privacy Policy">Privacy Policy </button>
                    <script>$(function (){
				 $('#terms').popover();
				 $('#privacy').popover();

		 	   });</script>   
		 </div>
                </div>
            </div>
        </div>
    </footer>

<!-- Registration Modal Window -->
<!--Modal Window -->
  <div class="container">
  <div class="modal fade" id="myModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">Register</h4>

      </div>
      <div id='div-form' class="modal-body">

   
     <form  action="/login/register/" id="id-registration" class="blueForms" method="post" ><input type='hidden' name='csrfmiddlewaretoken' value='K8KIoeCsCoj7n7gOlYBeRivztmNqMC9h' /> <div id="div_id_username" class="form-group"><label for="id_username" class="control-label  requiredField">
                Username<span class="asteriskField">*</span></label><div class="controls "><input class="textinput textInput form-control" id="id_username" maxlength="30" name="username" type="text" /> <p id="hint_id_username" class="help-block">Required. 30 characters or fewer. Letters, numbers and @/./+/-/_ characters</p></div></div><div id="div_id_email" class="form-group"><label for="id_email" class="control-label ">
                Email Address
            <span class="asteriskField">*</span></label><div class="controls "><input class="emailinput form-control" id="id_email" maxlength="75" name="email" type="email" /> </div></div><div id="div_id_first_name" class="form-group"><label for="id_first_name" class="control-label ">
                First Name
            </label><div class="controls "><input class="textinput textInput form-control" id="id_first_name" maxlength="30" name="first_name" type="text" /> </div></div><div id="div_id_last_name" class="form-group"><label for="id_last_name" class="control-label ">
                Last Name
            </label><div class="controls "><input class="textinput textInput form-control" id="id_last_name" maxlength="30" name="last_name" type="text" /> </div></div><div id="div_id_password" class="form-group"><label for="id_password" class="control-label  requiredField">
                Password<span class="asteriskField">*</span></label><div class="controls "><input class="textinput textInput form-control" id="id_password" name="password" type="password" /> </div></div><div class="form-actions"><input type="submit"
    name="submit"
    value="Submit"
    
        class="btn btn-primary"
        id="submit-id-submit" 
    
    /> </div></form>
         
	
<script>
$(document).ready(function () {
      var frm = $('#id-registration');
      
     frm.validate({
                
   		rules: {
   			username: {required: true},
   			email: {required: true},
   			password: {required: true}
  			
	},
 
     submitHandler: function(){
 	//*****loading animation*****//
	//frm.hide();
	//$("#submit-id-submit").attr('disabled', true);
	//$("#div-form").append('<span class="imgframe centerimg"><img src="http://i49.tinypic.com/33dbei8.jpg" id="loading_image" /></span>');
	       




        $.ajax({//begin
            type: 'POST', <!-- Get the form's method attribute(defined in login/forms.py -->
            url:  frm.attr('action'),  <!-- Get the form's action attribute(defined in login/forms.py -->
            data: frm.serialize(),    <!-- package the data -->
            success: function(result){
                if(result['success']){
	  		       
  			frm.hide();
			$("#div-form").html("<h3  style='text-align:center;'><strong>Thank you, for Registering!</strong></h3><h4>Please follow link in activation email to activate your account.</h4>");

		}
		else{
                	
			frm.replaceWith(result['form_html']);

		}
    		},
            error: function(data) {           
                $("#div-form").html("Failure!");
            }//end error
        });//end ajax
	
        return false;
        }	
});   
});

</script>

     <!-- Log In Modal Window --> 
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->  
</div>
<div class="container">
<!--Modal Window -->
  <div class="modal fade" id="myOtherModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">Login</h4>

      </div>
      <div id='div-form2' class="modal-body">
         <div id="loggedInMessage" class="alert alert-success" style='text-align:center;'>You're Logged In!</div>
	 <!-- <div id="loggedOutMessage" class="alert alert-success" style='text-align:center;'>You're Logged Out!</div> -->
         <!-- <div id="loggedInErrorMessage" class="alert alert-success" style='text-align:center;'><strong>Failed to log you in!</strong>Have you activated your account yet?</div>-->
        <form  action="/login/authenticate/" id="id-loginform" class="blueForms" method="post" >{% csrf_token %}<input type='hidden' name='csrfmiddlewaretoken' value='K8KIoeCsCoj7n7gOlYBeRivztmNqMC9h' /> <div id="div_id_username" class="form-group"><label for="id_username" class="control-label  requiredField">
                Username<span class="asteriskField">*</span></label><div class="controls "><input class="textinput textInput form-control" id="id_username" maxlength="30" name="username" type="text" /> <p id="hint_id_username" class="help-block">Required. 30 characters or fewer. Letters, numbers and @/./+/-/_ characters</p></div></div><div id="div_id_password" class="form-group"><label for="id_password" class="control-label  requiredField">
                Password<span class="asteriskField">*</span></label><div class="controls "><input class="textinput textInput form-control" id="id_password" name="password" type="password" /> </div></div><div class="form-actions"><input type="submit"
    name="submit"
    value="Submit"
    
        class="btn btn-primary"
        id="submit-id-submit"
    
    
    /> </div></form>
        <script>


$(document).ready(function () {
      var frm = $('#id-loginform');

     frm.validate({

                rules: {
                        username: {required: true},
                        password: {required: true}

        },

     submitHandler: function(){
      
        frm.hide();
        //$("#submit-id-submit").attr('disabled', true);
        //$("#div-form2").append('<span class="imgframe centerimg"><img src="http://i49.tinypic.com/33dbei8.jpg"/></span>');
	
        $.ajax({//begin
            
	    async: false,
	    type: 'POST', <!-- Get the form's method attribute(defined in login/forms.py -->
            url:  frm.attr('action'),         <!-- Get the form's action attribute(defined in login/forms.py -->
            data: frm.serialize(),    <!-- package the data -->
            success: function(result){
		    
                       
             	   if(result['success']){
			console.log('called')			
			
			changeNAV();
			
			frm.hide();
             		$("#loggedInMessage").show() 
			 
		   }
		   else{
		   

			frm.hide()
                        $("#div-form2").html("<h3 style='text-align:center;'>Failed To log you in!</h3><h4 style='text-align:center;'>Have you activated your account yet?</h4>");
		   }
             },
            error: function(data) {
                $("#div-form2").html("Failure!");
            }//end error
	   
        });//end ajax
        
        return false;
        }
}); 

  
});

    
</script>      
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
</div>

<!-- Logout Modal -->
<div class="modal fade" id="logoutModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">Logout</h4>
      </div>
      <div class="modal-body">
        <h3 style='text-align:center;'>You Are Logged Out</h3>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn btn-primary" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- Account Modal -->
<div class="modal fade bs-example-modal-sm" id="accountModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h4 class="modal-title">Account</h4>
	</div>
		<div class="modal-body">
			<h3 style='text-align:center;'>
	    			  <a class="btn btn btn-secondary" href="/companion/Fibers/"><strong>Textile Companion</strong></a>
			</h3>
			<h3 style='text-align:center;'>
			 	  <a class="btn btn btn-secondary" href="#"><strong>Update Account</strong></a>
			</h3>
			<h3 style='text-align:center;'>
                                  <a class="btn btn btn-secondary" href="#"><strong>Order History</strong></a>
                        </h3>	
		</div>
      <div class="modal-footer">
        <button type="button" class="btn btn btn-primary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

    <!-- JavaScript -->
    <script src="{% static 'js/bootstrap.js' %}"></script>
    
</body>
</html>
